<!DOCTYPE html>
<head th:insert="fragments/head.html"/>
<body>
<header th:insert="fragments/header.html"/>
<div class="container mt-3">
    <input class="form-control" id="orders-filter-input" type="text"
           placeholder="Type something in to search the table">
    <br>
    <table class="table table-bordered table-striped">
        <thead>
        <tr>
            <th>Instrument</th>
            <th>Strategy</th>
            <th>Lots</th>
            <th>Purchase price</th>
            <th>Purchase time</th>
            <th>Sell limit price</th>
            <th>Sell lots</th>
            <th>Sell price</th>
            <th>Sell time</th>
            <th>Commission</th>
            <th>Profit</th>
        </tr>
        </thead>
        <tbody id="orders-table">
        <tr th:each="o: ${orders}">
            <td>
                <span th:text="${o.figiTitle}"/>
                <a th:href="'strategy_dygraphs_by_fiat?strategy=' + ${o.strategy} + '&figi=' + ${o.figi}">График</a>
            </td>
            <td th:text="${o.strategy}"/>
            <td th:text="${o.lots}"/>
            <td>
                <span th:text="${o.purchasePrice == null ? null : #numbers.formatDecimal((o.purchasePriceMoney != null ? o.purchasePriceMoney : o.purchasePrice), 1, 4, 'DEFAULT')}"/>
                <span th:text="${o.purchasePrice == null ? null : #numbers.formatDecimal(o.purchasePrice, 1, 4, 'DEFAULT')}"
                      th:if="${o.purchasePriceMoney != null && o.purchasePriceMoney != o.purchasePrice}"/>
            </td>
            <td th:text="${o.purchaseDateTime == null ? null : T(com.struchev.invest.expression.Date).formatDateTime(o.purchaseDateTime)}"/>
            <td th:text="${o.sellPriceLimitWanted == null ? null : #numbers.formatDecimal(o.sellPriceLimitWanted, 1, 4, 'DEFAULT')}"/>
            <td th:text="${o.cellLots}"/>
            <td>
                <span th:text="${o.sellPrice == null ? null : #numbers.formatDecimal((o.sellPriceMoney != null ? o.sellPriceMoney: o.sellPrice), 1, 4, 'DEFAULT')}"/>
                <span th:text="${#numbers.formatDecimal(o.sellPrice, 1, 4, 'DEFAULT')}"
                      th:if="${o.sellPriceMoney != null && o.sellPriceMoney != o.sellPrice}"/>
            </td>
            <td th:text="${o.sellDateTime == null ? null : T(com.struchev.invest.expression.Date).formatDateTime(o.sellDateTime)}"/>
            <td th:text="${#numbers.formatDecimal(o.purchaseCommission.add(o.sellCommission == null ? 0 : o.sellCommission), 1, 2, 'DEFAULT')}"/>
            <td>
                <span th:text="${#numbers.formatDecimal((o.sellPriceMoney != null ? o.sellPriceMoney: o.sellPrice).subtract(o.purchasePriceMoney != null ? o.purchasePriceMoney : o.purchasePrice).multiply(o.lots).subtract(o.purchaseCommission).subtract(o.sellCommission), 1, 2, 'DEFAULT')}"
                      th:if="${o.purchasePrice != null && o.sellPrice != null && o.purchaseCommission != null && o.sellCommission != null}"/>
            </td>
        </tr>
        </tbody>
    </table>
    <script>
        $(document).ready(function () {
            $("#orders-filter-input").on("keyup", function () {
                var value = $(this).val().toLowerCase();
                $("#orders-table tr").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });
    </script>
</div>
</body>
</html>
